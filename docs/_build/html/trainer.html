

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Trainer subpackage &mdash; Avisaf  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Util subpackage" href="util.html" />
    <link rel="prev" title="Main subpackage" href="main.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Avisaf
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Content:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="avisaf.html">Avisaf  main package</a></li>
<li class="toctree-l1"><a class="reference internal" href="main.html">Main subpackage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Trainer subpackage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-trainer.new_entity_trainer">new_entity_trainer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-trainer.training_data_creator">training_data_creator module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="util.html">Util subpackage</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Avisaf</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="avisaf.html">Avisaf  main package</a> &raquo;</li>
        
      <li>Trainer subpackage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/trainer.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="trainer-subpackage">
<h1>Trainer subpackage<a class="headerlink" href="#trainer-subpackage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-trainer.new_entity_trainer">
<span id="new-entity-trainer-module"></span><h2>new_entity_trainer module<a class="headerlink" href="#module-trainer.new_entity_trainer" title="Permalink to this headline">¶</a></h2>
<p>New entity trainer is the module responsible for creating a new or updating
and improving an existing Named Entity Recognition model. The module uses
train_spaCy_model function which updates the model using spaCy.</p>
<dl class="py function">
<dt id="trainer.new_entity_trainer.train_spaCy_model">
<code class="sig-prename descclassname">trainer.new_entity_trainer.</code><code class="sig-name descname">train_spaCy_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iter_number</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">20</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">new_model_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tr_data_srcfile</span><span class="p">:</span> <span class="n">pathlib.Path</span> <span class="o">=</span> <span class="default_value">PosixPath('/home/viktor/Documents/avisaf_ner/new_doc/data_files/training_data/auto_annotated_data.json')</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#trainer.new_entity_trainer.train_spaCy_model" title="Permalink to this definition">¶</a></dt>
<dd><p>SpaCy NER model training function. The function iterates given number of
times over the given data in order to create an appropriate statistical
entity prediction model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verbose</strong> (<em>bool</em>) – A flag indicating verbose stdout printing.</p></li>
<li><p><strong>tr_data_srcfile</strong> (<em>Path</em>) – A path to the file containing training data based
based on which the spaCy model will be updated.</p></li>
<li><p><strong>iter_number</strong> (<em>int</em>) – Number of iterations for NER model updating.</p></li>
<li><p><strong>model</strong> (<em>str</em><em>, </em><em>Path</em>) – The string representation of a spaCy model. Either existing
pre-downloaded spaCy model or a path to a local directory.</p></li>
<li><p><strong>new_model_name</strong> (<em>str</em>) – New spaCy NER model will be saved under this name.
This parameter also makes part of the path where the model will be
saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns created NLP spaCy model.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-trainer.training_data_creator">
<span id="training-data-creator-module"></span><h2>training_data_creator module<a class="headerlink" href="#module-trainer.training_data_creator" title="Permalink to this headline">¶</a></h2>
<p>Training data creator is the module responsible for data annotation which can
be done either manually or automatically. Automatic data annotation is done
by using pre-created set of Matcher or PhraseMatcher rules which are then
applied to each of the given texts. Manual annotation is done by showing
the texts to the user and then letting him choose the words to be annotated
as well as the entity labels used for the chosen phrases.</p>
<dl class="py function">
<dt id="trainer.training_data_creator.annotate_auto">
<code class="sig-prename descclassname">trainer.training_data_creator.</code><code class="sig-name descname">annotate_auto</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">patterns_file_path</span><span class="p">:</span> <span class="n">pathlib.Path</span></em>, <em class="sig-param"><span class="n">label_text</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">'en_core_web_md'</span></em>, <em class="sig-param"><span class="n">tr_src_file</span><span class="p">:</span> <span class="n">pathlib.Path</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">extract_texts</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">use_phrasematcher</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#trainer.training_data_creator.annotate_auto" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatic annotation tool. The function takes a file which has to contain a
JSON list of rules to be matched. The rules are in the format compatible
with spaCy Matcher or PhraseMatcher objects. Rule recognition is done by
spaCy pattern matching in the given text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patterns_file_path</strong> (<em>Path</em>) – String representing a path to the file with
words to be matched (glossary etc).</p></li>
<li><p><strong>label_text</strong> (<em>str</em>) – The text of the label of an entity.</p></li>
<li><p><strong>model</strong> (<em>str</em><em>, </em><em>Path</em>) – Model to be loaded to spaCy. Either a valid spaCy pre-trained
model or a path to a local model.</p></li>
<li><p><strong>tr_src_file</strong> (<em>Path</em>) – Training data source file path. JSON file is supposed to
contain list of (text, annotations) tuples, where the text is the string
and annotations represents a dictionary with list of (start, end, label)
entity descriptors.</p></li>
<li><p><strong>extract_texts</strong> (<em>bool</em>) – A flag indicating whether new texts should be searched
for.</p></li>
<li><p><strong>use_phrasematcher</strong> (<em>bool</em>) – A flag indicating whether Matcher or PhraseMatcher
spaCy object is used.</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – A flag indicating whether the data should be saved in the same
tr_src_file.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – A flag indicating verbose stdout printing.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="trainer.training_data_creator.annotate_man">
<code class="sig-prename descclassname">trainer.training_data_creator.</code><code class="sig-name descname">annotate_man</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_path</span><span class="p">:</span> <span class="n">pathlib.Path</span></em>, <em class="sig-param"><span class="n">lines</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">labels_path</span><span class="p">:</span> <span class="n">pathlib.Path</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">start_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">save</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#trainer.training_data_creator.annotate_man" title="Permalink to this definition">¶</a></dt>
<dd><p>Manual text annotation tool. A set of texts from file_path parameter
starting with start_index is progressively printed in order to be annotated
by labels given in the labels_path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels_path</strong> (<em>Path</em>) – Path to the file containing available entity labels.</p></li>
<li><p><strong>file_path</strong> (<em>Path</em>) – The path to the file containing texts to be annotated.
If None, then a user can write own sentences and
annotate them.</p></li>
<li><p><strong>lines</strong> (<em>int</em>) – The number of texts to be annotated (1 text = 1 line).</p></li>
<li><p><strong>start_index</strong> (<em>int</em>) – The index of the first text to be annotated.</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – A flag indicating whether the result of the annotation
should be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of texts and its annotations.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-trainer"></span></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="util.html" class="btn btn-neutral float-right" title="Util subpackage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="main.html" class="btn btn-neutral float-left" title="Main subpackage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Viktor Bujko

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>