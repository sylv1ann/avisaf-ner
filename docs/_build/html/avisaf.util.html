

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>avisaf.util package &mdash; Avisaf  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="avisaf.trainer package" href="avisaf.trainer.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Avisaf
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">avisaf</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="avisaf.html">avisaf package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="avisaf.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="avisaf.main.html">avisaf.main package</a></li>
<li class="toctree-l4"><a class="reference internal" href="avisaf.trainer.html">avisaf.trainer package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">avisaf.util package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="avisaf.html#module-avisaf">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Avisaf</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">avisaf</a> &raquo;</li>
        
          <li><a href="avisaf.html">avisaf package</a> &raquo;</li>
        
      <li>avisaf.util package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/avisaf.util.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="avisaf-util-package">
<h1>avisaf.util package<a class="headerlink" href="#avisaf-util-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-avisaf.util.data_extractor">
<span id="avisaf-util-data-extractor-module"></span><h2>avisaf.util.data_extractor module<a class="headerlink" href="#module-avisaf.util.data_extractor" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="avisaf.util.data_extractor.get_entities">
<code class="sig-prename descclassname">avisaf.util.data_extractor.</code><code class="sig-name descname">get_entities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">entities_file_path</span><span class="p">:</span> <span class="n">pathlib.Path</span> <span class="o">=</span> <span class="default_value">PosixPath('/home/viktor/Documents/avisaf_ner/data_files/entities_labels.json')</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.data_extractor.get_entities" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>entities_file_path</strong> (<em>Path</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="avisaf.util.data_extractor.get_narratives">
<code class="sig-prename descclassname">avisaf.util.data_extractor.</code><code class="sig-name descname">get_narratives</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lines</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">file_path</span><span class="p">:</span> <span class="n">pathlib.Path</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">start_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.data_extractor.get_narratives" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lines</strong> (<em>int</em>) – </p></li>
<li><p><strong>file_path</strong> (<em>Path</em>) – </p></li>
<li><p><strong>start_index</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a generator of all texts.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="avisaf.util.data_extractor.get_training_data">
<code class="sig-prename descclassname">avisaf.util.data_extractor.</code><code class="sig-name descname">get_training_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">training_data_file_path</span><span class="p">:</span> <span class="n">pathlib.Path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.data_extractor.get_training_data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>training_data_file_path</strong> (<em>Path</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>JSON list of (text, annotations) tuples.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-avisaf.util.indexing">
<span id="avisaf-util-indexing-module"></span><h2>avisaf.util.indexing module<a class="headerlink" href="#module-avisaf.util.indexing" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="avisaf.util.indexing.find_indexes">
<code class="sig-prename descclassname">avisaf.util.indexing.</code><code class="sig-name descname">find_indexes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">text</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">span</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">start_offset</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.indexing.find_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Method which returns the indexes of a substring of a string, if such substring
exists, otherwise return (-1, -1) tuple.
:type text:          str
:param text:         The sentence string.
:type span:          str
:param span:         A substring to be searched for.
:type start_offset:  int
:param start_offset: TO BE DONE
:return:             (start_index, end_index) tuple or (-1, -1) if span is not in the text.</p>
</dd></dl>

<dl class="py function">
<dt id="avisaf.util.indexing.get_span_indexes">
<code class="sig-prename descclassname">avisaf.util.indexing.</code><code class="sig-name descname">get_span_indexes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">text</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">span</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.indexing.get_span_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Launches the search for a given span in given text. Allows also looking for more complex,
token-composed spans.
:type text:     str
:param text:
:type span:     str
:param span:
:return:</p>
</dd></dl>

<dl class="py function">
<dt id="avisaf.util.indexing.get_spans_indexes">
<code class="sig-prename descclassname">avisaf.util.indexing.</code><code class="sig-name descname">get_spans_indexes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sentence</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">spans</span><span class="p">:</span> <span class="n">list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.indexing.get_spans_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as get_span_indexes function, but takes a list of spans instead of a single span.
:type sentence:     str
:param sentence:    The sentence string.
:type spans:        list
:param spans:       List of substrings to be searched for.
:return:            List of (start_index, end_index) pairs.</p>
</dd></dl>

<dl class="py function">
<dt id="avisaf.util.indexing.get_training_data">
<code class="sig-prename descclassname">avisaf.util.indexing.</code><code class="sig-name descname">get_training_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="p">:</span> <span class="n">pathlib.Path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.indexing.get_training_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the training data from a given file.
:param path: The file path to the training data JSON file.
:return: The list of (text, annotations) tuples.</p>
</dd></dl>

<dl class="py function">
<dt id="avisaf.util.indexing.print_matches">
<code class="sig-prename descclassname">avisaf.util.indexing.</code><code class="sig-name descname">print_matches</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">match_text</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">entities_dict</span><span class="p">:</span> <span class="n">dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.indexing.print_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which takes a text, and its annotated entities,
and prints the annotated text along with its labeled entity.
:type match_text:       str
:param match_text:      The text to be searched in for labeled entities.
:type entities_dict:    dict
:param entities_dict:   The dictionary with ‘entities key containing the list of</p>
<blockquote>
<div><p>(start_index, end_index, label) entities of the text.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="avisaf.util.indexing.trim_entity_spans">
<code class="sig-prename descclassname">avisaf.util.indexing.</code><code class="sig-name descname">trim_entity_spans</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_file_path</span><span class="p">:</span> <span class="n">pathlib.Path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.indexing.trim_entity_spans" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes leading and trailing white spaces from entity spans.
:type data_file_path:   Path
:param data_file_path:  Data in spaCy JSON format to have leading and trailing whitespaces removed.
:return                 Returns the list without leading/trailing whitespaces.</p>
</dd></dl>

</div>
<div class="section" id="module-avisaf.util.training_data_build">
<span id="avisaf-util-training-data-build-module"></span><h2>avisaf.util.training_data_build module<a class="headerlink" href="#module-avisaf.util.training_data_build" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="avisaf.util.training_data_build.overlap_between">
<code class="sig-prename descclassname">avisaf.util.training_data_build.</code><code class="sig-name descname">overlap_between</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">entity_triplet</span></em>, <em class="sig-param"><span class="n">next_triplet</span></em>, <em class="sig-param"><span class="n">text</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.training_data_build.overlap_between" title="Permalink to this definition">¶</a></dt>
<dd><p>Detects whether there is an overlap between two triplets in the given text.
If the two entities have the same label, shorter triplet is removed.
Otherwise, the user is prompted to decide which one should be removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> (<em>str</em>) – The text string in which the overlap was found.</p></li>
<li><p><strong>entity_triplet</strong> (<em>tuple</em>) – First  (start_index, end_index, label) entity descriptor.</p></li>
<li><p><strong>next_triplet</strong> (<em>tuple</em>) – Second (start_index, end_index, label) entity descriptor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns the triplet to be removed - the one which
represents a shorter part of the text.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="avisaf.util.training_data_build.pretty_print_training_data">
<code class="sig-prename descclassname">avisaf.util.training_data_build.</code><code class="sig-name descname">pretty_print_training_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="p">:</span> <span class="n">pathlib.Path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.training_data_build.pretty_print_training_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints each tuple object of the document in a new line instead of a single
very long line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>Path</em>) – The path of the file to be rewritten.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="avisaf.util.training_data_build.remove_overlaps_from_dict">
<code class="sig-prename descclassname">avisaf.util.training_data_build.</code><code class="sig-name descname">remove_overlaps_from_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">annotations_dict</span><span class="p">:</span> <span class="n">dict</span></em>, <em class="sig-param"><span class="n">text</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.training_data_build.remove_overlaps_from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes overlapping annotations from the annotations_dict[‘entities’] list
of (start_index, end_index, label) tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> (<em>str</em>) – The text string overlaps should be removed from.</p></li>
<li><p><strong>annotations_dict</strong> (<em>dict</em>) – The dictionary containing the annotations list under
‘entities’ key.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The list of new annotations without overlaps.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="avisaf.util.training_data_build.remove_overlaps_from_file">
<code class="sig-prename descclassname">avisaf.util.training_data_build.</code><code class="sig-name descname">remove_overlaps_from_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_path</span><span class="p">:</span> <span class="n">pathlib.Path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.training_data_build.remove_overlaps_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>The function removes overlapping annotations from all the (text, annotations)
tuples in JSON file specified in the file_path argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>file</em>) – The path to the JSON file which will have all overlapping annotations removed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns the content of the JSON file in the file_path arg without overlapping annotations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="avisaf.util.training_data_build.sort_annotations">
<code class="sig-prename descclassname">avisaf.util.training_data_build.</code><code class="sig-name descname">sort_annotations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_path</span><span class="p">:</span> <span class="n">pathlib.Path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.training_data_build.sort_annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that sorts the (start_index, end_index, label) tuples based by
their position in the given text. Sorting is done for every line of a JSON
training data file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>Path</em>) – Path of the JSON file containing the list of
(text, entities) tuples, which will have entities sorted.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="avisaf.util.training_data_build.write_sentences">
<code class="sig-prename descclassname">avisaf.util.training_data_build.</code><code class="sig-name descname">write_sentences</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#avisaf.util.training_data_build.write_sentences" title="Permalink to this definition">¶</a></dt>
<dd><p>A loop which prompts a user to input a sentence which will be annotated
later. The function end when string ‘None’ is detected
:return: The list of user-written sentences.</p>
</dd></dl>

</div>
<div class="section" id="module-avisaf.util">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-avisaf.util" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="avisaf.trainer.html" class="btn btn-neutral float-left" title="avisaf.trainer package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Viktor Bujko

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>